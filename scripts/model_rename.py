# 04/20/2020, Dan
# This file is used to transform the pretrained i3d flow model to the format of STEP
# Pretrained Model is at https://github.com/piergiaj/pytorch-i3d
import torch
from collections import OrderedDict

def main():
    state_dict = torch.load("pretrained/flow_imagenet.pt")
    
    state_dict_STEP = OrderedDict()
    state_dict_STEP['conv3d_1a_7x7.conv3d.weight'] = state_dict['Conv3d_1a_7x7.conv3d.weight']
    state_dict_STEP['conv3d_1a_7x7.batch3d.weight'] = state_dict['Conv3d_1a_7x7.bn.weight']
    state_dict_STEP['conv3d_1a_7x7.batch3d.bias'] = state_dict['Conv3d_1a_7x7.bn.bias']
    state_dict_STEP['conv3d_1a_7x7.batch3d.running_mean'] = state_dict['Conv3d_1a_7x7.bn.running_mean']
    state_dict_STEP['conv3d_1a_7x7.batch3d.running_var'] = state_dict['Conv3d_1a_7x7.bn.running_var']
    state_dict_STEP['conv3d_2b_1x1.conv3d.weight'] = state_dict['Conv3d_2b_1x1.conv3d.weight']
    state_dict_STEP['conv3d_2b_1x1.batch3d.weight'] = state_dict['Conv3d_2b_1x1.bn.weight']
    state_dict_STEP['conv3d_2b_1x1.batch3d.bias'] = state_dict['Conv3d_2b_1x1.bn.bias']
    state_dict_STEP['conv3d_2b_1x1.batch3d.running_mean'] = state_dict['Conv3d_2b_1x1.bn.running_mean']
    state_dict_STEP['conv3d_2b_1x1.batch3d.running_var'] = state_dict['Conv3d_2b_1x1.bn.running_var']
    state_dict_STEP['conv3d_2c_3x3.conv3d.weight'] = state_dict['Conv3d_2c_3x3.conv3d.weight']
    state_dict_STEP['conv3d_2c_3x3.batch3d.weight'] = state_dict['Conv3d_2c_3x3.bn.weight']
    state_dict_STEP['conv3d_2c_3x3.batch3d.bias'] = state_dict['Conv3d_2c_3x3.bn.bias']
    state_dict_STEP['conv3d_2c_3x3.batch3d.running_mean'] = state_dict['Conv3d_2c_3x3.bn.running_mean']
    state_dict_STEP['conv3d_2c_3x3.batch3d.running_var'] = state_dict['Conv3d_2c_3x3.bn.running_var']
    state_dict_STEP['mixed_3b.branch_0.conv3d.weight'] = state_dict['Mixed_3b.b0.conv3d.weight']
    state_dict_STEP['mixed_3b.branch_0.batch3d.weight'] = state_dict['Mixed_3b.b0.bn.weight']
    state_dict_STEP['mixed_3b.branch_0.batch3d.bias'] = state_dict['Mixed_3b.b0.bn.bias']
    state_dict_STEP['mixed_3b.branch_0.batch3d.running_mean'] = state_dict['Mixed_3b.b0.bn.running_mean']
    state_dict_STEP['mixed_3b.branch_0.batch3d.running_var'] = state_dict['Mixed_3b.b0.bn.running_var']
    state_dict_STEP['mixed_3b.branch_1.0.conv3d.weight'] = state_dict['Mixed_3b.b1a.conv3d.weight']
    state_dict_STEP['mixed_3b.branch_1.0.batch3d.weight'] = state_dict['Mixed_3b.b1a.bn.weight']
    state_dict_STEP['mixed_3b.branch_1.0.batch3d.bias'] = state_dict['Mixed_3b.b1a.bn.bias']
    state_dict_STEP['mixed_3b.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_3b.b1a.bn.running_mean']
    state_dict_STEP['mixed_3b.branch_1.0.batch3d.running_var'] = state_dict['Mixed_3b.b1a.bn.running_var']
    state_dict_STEP['mixed_3b.branch_1.1.conv3d.weight'] = state_dict['Mixed_3b.b1b.conv3d.weight']
    state_dict_STEP['mixed_3b.branch_1.1.batch3d.weight'] = state_dict['Mixed_3b.b1b.bn.weight']
    state_dict_STEP['mixed_3b.branch_1.1.batch3d.bias'] = state_dict['Mixed_3b.b1b.bn.bias']
    state_dict_STEP['mixed_3b.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_3b.b1b.bn.running_mean']
    state_dict_STEP['mixed_3b.branch_1.1.batch3d.running_var'] = state_dict['Mixed_3b.b1b.bn.running_var']
    state_dict_STEP['mixed_3b.branch_2.0.conv3d.weight'] = state_dict['Mixed_3b.b2a.conv3d.weight']
    state_dict_STEP['mixed_3b.branch_2.0.batch3d.weight'] = state_dict['Mixed_3b.b2a.bn.weight']
    state_dict_STEP['mixed_3b.branch_2.0.batch3d.bias'] = state_dict['Mixed_3b.b2a.bn.bias']
    state_dict_STEP['mixed_3b.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_3b.b2a.bn.running_mean']
    state_dict_STEP['mixed_3b.branch_2.0.batch3d.running_var'] = state_dict['Mixed_3b.b2a.bn.running_var']
    state_dict_STEP['mixed_3b.branch_2.1.conv3d.weight'] = state_dict['Mixed_3b.b2b.conv3d.weight']
    state_dict_STEP['mixed_3b.branch_2.1.batch3d.weight'] = state_dict['Mixed_3b.b2b.bn.weight']
    state_dict_STEP['mixed_3b.branch_2.1.batch3d.bias'] = state_dict['Mixed_3b.b2b.bn.bias']
    state_dict_STEP['mixed_3b.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_3b.b2b.bn.running_mean']
    state_dict_STEP['mixed_3b.branch_2.1.batch3d.running_var'] = state_dict['Mixed_3b.b2b.bn.running_var']
    state_dict_STEP['mixed_3b.branch_3.1.conv3d.weight'] = state_dict['Mixed_3b.b3b.conv3d.weight']
    state_dict_STEP['mixed_3b.branch_3.1.batch3d.weight'] = state_dict['Mixed_3b.b3b.bn.weight']
    state_dict_STEP['mixed_3b.branch_3.1.batch3d.bias'] = state_dict['Mixed_3b.b3b.bn.bias']
    state_dict_STEP['mixed_3b.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_3b.b3b.bn.running_mean']
    state_dict_STEP['mixed_3b.branch_3.1.batch3d.running_var'] = state_dict['Mixed_3b.b3b.bn.running_var']
    state_dict_STEP['mixed_3c.branch_0.conv3d.weight'] = state_dict['Mixed_3c.b0.conv3d.weight']
    state_dict_STEP['mixed_3c.branch_0.batch3d.weight'] = state_dict['Mixed_3c.b0.bn.weight']
    state_dict_STEP['mixed_3c.branch_0.batch3d.bias'] = state_dict['Mixed_3c.b0.bn.bias']
    state_dict_STEP['mixed_3c.branch_0.batch3d.running_mean'] = state_dict['Mixed_3c.b0.bn.running_mean']
    state_dict_STEP['mixed_3c.branch_0.batch3d.running_var'] = state_dict['Mixed_3c.b0.bn.running_var']
    state_dict_STEP['mixed_3c.branch_1.0.conv3d.weight'] = state_dict['Mixed_3c.b1a.conv3d.weight']
    state_dict_STEP['mixed_3c.branch_1.0.batch3d.weight'] = state_dict['Mixed_3c.b1a.bn.weight']
    state_dict_STEP['mixed_3c.branch_1.0.batch3d.bias'] = state_dict['Mixed_3c.b1a.bn.bias']
    state_dict_STEP['mixed_3c.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_3c.b1a.bn.running_mean']
    state_dict_STEP['mixed_3c.branch_1.0.batch3d.running_var'] = state_dict['Mixed_3c.b1a.bn.running_var']
    state_dict_STEP['mixed_3c.branch_1.1.conv3d.weight'] = state_dict['Mixed_3c.b1b.conv3d.weight']
    state_dict_STEP['mixed_3c.branch_1.1.batch3d.weight'] = state_dict['Mixed_3c.b1b.bn.weight']
    state_dict_STEP['mixed_3c.branch_1.1.batch3d.bias'] = state_dict['Mixed_3c.b1b.bn.bias']
    state_dict_STEP['mixed_3c.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_3c.b1b.bn.running_mean']
    state_dict_STEP['mixed_3c.branch_1.1.batch3d.running_var'] = state_dict['Mixed_3c.b1b.bn.running_var']
    state_dict_STEP['mixed_3c.branch_2.0.conv3d.weight'] = state_dict['Mixed_3c.b2a.conv3d.weight']
    state_dict_STEP['mixed_3c.branch_2.0.batch3d.weight'] = state_dict['Mixed_3c.b2a.bn.weight']
    state_dict_STEP['mixed_3c.branch_2.0.batch3d.bias'] = state_dict['Mixed_3c.b2a.bn.bias']
    state_dict_STEP['mixed_3c.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_3c.b2a.bn.running_mean']
    state_dict_STEP['mixed_3c.branch_2.0.batch3d.running_var'] = state_dict['Mixed_3c.b2a.bn.running_var']
    state_dict_STEP['mixed_3c.branch_2.1.conv3d.weight'] = state_dict['Mixed_3c.b2b.conv3d.weight']
    state_dict_STEP['mixed_3c.branch_2.1.batch3d.weight'] = state_dict['Mixed_3c.b2b.bn.weight']
    state_dict_STEP['mixed_3c.branch_2.1.batch3d.bias'] = state_dict['Mixed_3c.b2b.bn.bias']
    state_dict_STEP['mixed_3c.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_3c.b2b.bn.running_mean']
    state_dict_STEP['mixed_3c.branch_2.1.batch3d.running_var'] = state_dict['Mixed_3c.b2b.bn.running_var']
    state_dict_STEP['mixed_3c.branch_3.1.conv3d.weight'] = state_dict['Mixed_3c.b3b.conv3d.weight']
    state_dict_STEP['mixed_3c.branch_3.1.batch3d.weight'] = state_dict['Mixed_3c.b3b.bn.weight']
    state_dict_STEP['mixed_3c.branch_3.1.batch3d.bias'] = state_dict['Mixed_3c.b3b.bn.bias']
    state_dict_STEP['mixed_3c.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_3c.b3b.bn.running_mean']
    state_dict_STEP['mixed_3c.branch_3.1.batch3d.running_var'] = state_dict['Mixed_3c.b3b.bn.running_var']
    state_dict_STEP['mixed_4b.branch_0.conv3d.weight'] = state_dict['Mixed_4b.b0.conv3d.weight']
    state_dict_STEP['mixed_4b.branch_0.batch3d.weight'] = state_dict['Mixed_4b.b0.bn.weight']
    state_dict_STEP['mixed_4b.branch_0.batch3d.bias'] = state_dict['Mixed_4b.b0.bn.bias']
    state_dict_STEP['mixed_4b.branch_0.batch3d.running_mean'] = state_dict['Mixed_4b.b0.bn.running_mean']
    state_dict_STEP['mixed_4b.branch_0.batch3d.running_var'] = state_dict['Mixed_4b.b0.bn.running_var']
    state_dict_STEP['mixed_4b.branch_1.0.conv3d.weight'] = state_dict['Mixed_4b.b1a.conv3d.weight']
    state_dict_STEP['mixed_4b.branch_1.0.batch3d.weight'] = state_dict['Mixed_4b.b1a.bn.weight']
    state_dict_STEP['mixed_4b.branch_1.0.batch3d.bias'] = state_dict['Mixed_4b.b1a.bn.bias']
    state_dict_STEP['mixed_4b.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_4b.b1a.bn.running_mean']
    state_dict_STEP['mixed_4b.branch_1.0.batch3d.running_var'] = state_dict['Mixed_4b.b1a.bn.running_var']
    state_dict_STEP['mixed_4b.branch_1.1.conv3d.weight'] = state_dict['Mixed_4b.b1b.conv3d.weight']
    state_dict_STEP['mixed_4b.branch_1.1.batch3d.weight'] = state_dict['Mixed_4b.b1b.bn.weight']
    state_dict_STEP['mixed_4b.branch_1.1.batch3d.bias'] = state_dict['Mixed_4b.b1b.bn.bias']
    state_dict_STEP['mixed_4b.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_4b.b1b.bn.running_mean']
    state_dict_STEP['mixed_4b.branch_1.1.batch3d.running_var'] = state_dict['Mixed_4b.b1b.bn.running_var']
    state_dict_STEP['mixed_4b.branch_2.0.conv3d.weight'] = state_dict['Mixed_4b.b2a.conv3d.weight']
    state_dict_STEP['mixed_4b.branch_2.0.batch3d.weight'] = state_dict['Mixed_4b.b2a.bn.weight']
    state_dict_STEP['mixed_4b.branch_2.0.batch3d.bias'] = state_dict['Mixed_4b.b2a.bn.bias']
    state_dict_STEP['mixed_4b.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_4b.b2a.bn.running_mean']
    state_dict_STEP['mixed_4b.branch_2.0.batch3d.running_var'] = state_dict['Mixed_4b.b2a.bn.running_var']
    state_dict_STEP['mixed_4b.branch_2.1.conv3d.weight'] = state_dict['Mixed_4b.b2b.conv3d.weight']
    state_dict_STEP['mixed_4b.branch_2.1.batch3d.weight'] = state_dict['Mixed_4b.b2b.bn.weight']
    state_dict_STEP['mixed_4b.branch_2.1.batch3d.bias'] = state_dict['Mixed_4b.b2b.bn.bias']
    state_dict_STEP['mixed_4b.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_4b.b2b.bn.running_mean']
    state_dict_STEP['mixed_4b.branch_2.1.batch3d.running_var'] = state_dict['Mixed_4b.b2b.bn.running_var']
    state_dict_STEP['mixed_4b.branch_3.1.conv3d.weight'] = state_dict['Mixed_4b.b3b.conv3d.weight']
    state_dict_STEP['mixed_4b.branch_3.1.batch3d.weight'] = state_dict['Mixed_4b.b3b.bn.weight']
    state_dict_STEP['mixed_4b.branch_3.1.batch3d.bias'] = state_dict['Mixed_4b.b3b.bn.bias']
    state_dict_STEP['mixed_4b.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_4b.b3b.bn.running_mean']
    state_dict_STEP['mixed_4b.branch_3.1.batch3d.running_var'] = state_dict['Mixed_4b.b3b.bn.running_var']
    state_dict_STEP['mixed_4c.branch_0.conv3d.weight'] = state_dict['Mixed_4c.b0.conv3d.weight']
    state_dict_STEP['mixed_4c.branch_0.batch3d.weight'] = state_dict['Mixed_4c.b0.bn.weight']
    state_dict_STEP['mixed_4c.branch_0.batch3d.bias'] = state_dict['Mixed_4c.b0.bn.bias']
    state_dict_STEP['mixed_4c.branch_0.batch3d.running_mean'] = state_dict['Mixed_4c.b0.bn.running_mean']
    state_dict_STEP['mixed_4c.branch_0.batch3d.running_var'] = state_dict['Mixed_4c.b0.bn.running_var']
    state_dict_STEP['mixed_4c.branch_1.0.conv3d.weight'] = state_dict['Mixed_4c.b1a.conv3d.weight']
    state_dict_STEP['mixed_4c.branch_1.0.batch3d.weight'] = state_dict['Mixed_4c.b1a.bn.weight']
    state_dict_STEP['mixed_4c.branch_1.0.batch3d.bias'] = state_dict['Mixed_4c.b1a.bn.bias']
    state_dict_STEP['mixed_4c.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_4c.b1a.bn.running_mean']
    state_dict_STEP['mixed_4c.branch_1.0.batch3d.running_var'] = state_dict['Mixed_4c.b1a.bn.running_var']
    state_dict_STEP['mixed_4c.branch_1.1.conv3d.weight'] = state_dict['Mixed_4c.b1b.conv3d.weight']
    state_dict_STEP['mixed_4c.branch_1.1.batch3d.weight'] = state_dict['Mixed_4c.b1b.bn.weight']
    state_dict_STEP['mixed_4c.branch_1.1.batch3d.bias'] = state_dict['Mixed_4c.b1b.bn.bias']
    state_dict_STEP['mixed_4c.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_4c.b1b.bn.running_mean']
    state_dict_STEP['mixed_4c.branch_1.1.batch3d.running_var'] = state_dict['Mixed_4c.b1b.bn.running_var']
    state_dict_STEP['mixed_4c.branch_2.0.conv3d.weight'] = state_dict['Mixed_4c.b2a.conv3d.weight']
    state_dict_STEP['mixed_4c.branch_2.0.batch3d.weight'] = state_dict['Mixed_4c.b2a.bn.weight']
    state_dict_STEP['mixed_4c.branch_2.0.batch3d.bias'] = state_dict['Mixed_4c.b2a.bn.bias']
    state_dict_STEP['mixed_4c.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_4c.b2a.bn.running_mean']
    state_dict_STEP['mixed_4c.branch_2.0.batch3d.running_var'] = state_dict['Mixed_4c.b2a.bn.running_var']
    state_dict_STEP['mixed_4c.branch_2.1.conv3d.weight'] = state_dict['Mixed_4c.b2b.conv3d.weight']
    state_dict_STEP['mixed_4c.branch_2.1.batch3d.weight'] = state_dict['Mixed_4c.b2b.bn.weight']
    state_dict_STEP['mixed_4c.branch_2.1.batch3d.bias'] = state_dict['Mixed_4c.b2b.bn.bias']
    state_dict_STEP['mixed_4c.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_4c.b2b.bn.running_mean']
    state_dict_STEP['mixed_4c.branch_2.1.batch3d.running_var'] = state_dict['Mixed_4c.b2b.bn.running_var']
    state_dict_STEP['mixed_4c.branch_3.1.conv3d.weight'] = state_dict['Mixed_4c.b3b.conv3d.weight']
    state_dict_STEP['mixed_4c.branch_3.1.batch3d.weight'] = state_dict['Mixed_4c.b3b.bn.weight']
    state_dict_STEP['mixed_4c.branch_3.1.batch3d.bias'] = state_dict['Mixed_4c.b3b.bn.bias']
    state_dict_STEP['mixed_4c.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_4c.b3b.bn.running_mean']
    state_dict_STEP['mixed_4c.branch_3.1.batch3d.running_var'] = state_dict['Mixed_4c.b3b.bn.running_var']
    state_dict_STEP['mixed_4d.branch_0.conv3d.weight'] = state_dict['Mixed_4d.b0.conv3d.weight']
    state_dict_STEP['mixed_4d.branch_0.batch3d.weight'] = state_dict['Mixed_4d.b0.bn.weight']
    state_dict_STEP['mixed_4d.branch_0.batch3d.bias'] = state_dict['Mixed_4d.b0.bn.bias']
    state_dict_STEP['mixed_4d.branch_0.batch3d.running_mean'] = state_dict['Mixed_4d.b0.bn.running_mean']
    state_dict_STEP['mixed_4d.branch_0.batch3d.running_var'] = state_dict['Mixed_4d.b0.bn.running_var']
    state_dict_STEP['mixed_4d.branch_1.0.conv3d.weight'] = state_dict['Mixed_4d.b1a.conv3d.weight']
    state_dict_STEP['mixed_4d.branch_1.0.batch3d.weight'] = state_dict['Mixed_4d.b1a.bn.weight']
    state_dict_STEP['mixed_4d.branch_1.0.batch3d.bias'] = state_dict['Mixed_4d.b1a.bn.bias']
    state_dict_STEP['mixed_4d.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_4d.b1a.bn.running_mean']
    state_dict_STEP['mixed_4d.branch_1.0.batch3d.running_var'] = state_dict['Mixed_4d.b1a.bn.running_var']
    state_dict_STEP['mixed_4d.branch_1.1.conv3d.weight'] = state_dict['Mixed_4d.b1b.conv3d.weight']
    state_dict_STEP['mixed_4d.branch_1.1.batch3d.weight'] = state_dict['Mixed_4d.b1b.bn.weight']
    state_dict_STEP['mixed_4d.branch_1.1.batch3d.bias'] = state_dict['Mixed_4d.b1b.bn.bias']
    state_dict_STEP['mixed_4d.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_4d.b1b.bn.running_mean']
    state_dict_STEP['mixed_4d.branch_1.1.batch3d.running_var'] = state_dict['Mixed_4d.b1b.bn.running_var']
    state_dict_STEP['mixed_4d.branch_2.0.conv3d.weight'] = state_dict['Mixed_4d.b2a.conv3d.weight']
    state_dict_STEP['mixed_4d.branch_2.0.batch3d.weight'] = state_dict['Mixed_4d.b2a.bn.weight']
    state_dict_STEP['mixed_4d.branch_2.0.batch3d.bias'] = state_dict['Mixed_4d.b2a.bn.bias']
    state_dict_STEP['mixed_4d.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_4d.b2a.bn.running_mean']
    state_dict_STEP['mixed_4d.branch_2.0.batch3d.running_var'] = state_dict['Mixed_4d.b2a.bn.running_var']
    state_dict_STEP['mixed_4d.branch_2.1.conv3d.weight'] = state_dict['Mixed_4d.b2b.conv3d.weight']
    state_dict_STEP['mixed_4d.branch_2.1.batch3d.weight'] = state_dict['Mixed_4d.b2b.bn.weight']
    state_dict_STEP['mixed_4d.branch_2.1.batch3d.bias'] = state_dict['Mixed_4d.b2b.bn.bias']
    state_dict_STEP['mixed_4d.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_4d.b2b.bn.running_mean']
    state_dict_STEP['mixed_4d.branch_2.1.batch3d.running_var'] = state_dict['Mixed_4d.b2b.bn.running_var']
    state_dict_STEP['mixed_4d.branch_3.1.conv3d.weight'] = state_dict['Mixed_4d.b3b.conv3d.weight']
    state_dict_STEP['mixed_4d.branch_3.1.batch3d.weight'] = state_dict['Mixed_4d.b3b.bn.weight']
    state_dict_STEP['mixed_4d.branch_3.1.batch3d.bias'] = state_dict['Mixed_4d.b3b.bn.bias']
    state_dict_STEP['mixed_4d.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_4d.b3b.bn.running_mean']
    state_dict_STEP['mixed_4d.branch_3.1.batch3d.running_var'] = state_dict['Mixed_4d.b3b.bn.running_var']
    state_dict_STEP['mixed_4e.branch_0.conv3d.weight'] = state_dict['Mixed_4e.b0.conv3d.weight']
    state_dict_STEP['mixed_4e.branch_0.batch3d.weight'] = state_dict['Mixed_4e.b0.bn.weight']
    state_dict_STEP['mixed_4e.branch_0.batch3d.bias'] = state_dict['Mixed_4e.b0.bn.bias']
    state_dict_STEP['mixed_4e.branch_0.batch3d.running_mean'] = state_dict['Mixed_4e.b0.bn.running_mean']
    state_dict_STEP['mixed_4e.branch_0.batch3d.running_var'] = state_dict['Mixed_4e.b0.bn.running_var']
    state_dict_STEP['mixed_4e.branch_1.0.conv3d.weight'] = state_dict['Mixed_4e.b1a.conv3d.weight']
    state_dict_STEP['mixed_4e.branch_1.0.batch3d.weight'] = state_dict['Mixed_4e.b1a.bn.weight']
    state_dict_STEP['mixed_4e.branch_1.0.batch3d.bias'] = state_dict['Mixed_4e.b1a.bn.bias']
    state_dict_STEP['mixed_4e.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_4e.b1a.bn.running_mean']
    state_dict_STEP['mixed_4e.branch_1.0.batch3d.running_var'] = state_dict['Mixed_4e.b1a.bn.running_var']
    state_dict_STEP['mixed_4e.branch_1.1.conv3d.weight'] = state_dict['Mixed_4e.b1b.conv3d.weight']
    state_dict_STEP['mixed_4e.branch_1.1.batch3d.weight'] = state_dict['Mixed_4e.b1b.bn.weight']
    state_dict_STEP['mixed_4e.branch_1.1.batch3d.bias'] = state_dict['Mixed_4e.b1b.bn.bias']
    state_dict_STEP['mixed_4e.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_4e.b1b.bn.running_mean']
    state_dict_STEP['mixed_4e.branch_1.1.batch3d.running_var'] = state_dict['Mixed_4e.b1b.bn.running_var']
    state_dict_STEP['mixed_4e.branch_2.0.conv3d.weight'] = state_dict['Mixed_4e.b2a.conv3d.weight']
    state_dict_STEP['mixed_4e.branch_2.0.batch3d.weight'] = state_dict['Mixed_4e.b2a.bn.weight']
    state_dict_STEP['mixed_4e.branch_2.0.batch3d.bias'] = state_dict['Mixed_4e.b2a.bn.bias']
    state_dict_STEP['mixed_4e.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_4e.b2a.bn.running_mean']
    state_dict_STEP['mixed_4e.branch_2.0.batch3d.running_var'] = state_dict['Mixed_4e.b2a.bn.running_var']
    state_dict_STEP['mixed_4e.branch_2.1.conv3d.weight'] = state_dict['Mixed_4e.b2b.conv3d.weight']
    state_dict_STEP['mixed_4e.branch_2.1.batch3d.weight'] = state_dict['Mixed_4e.b2b.bn.weight']
    state_dict_STEP['mixed_4e.branch_2.1.batch3d.bias'] = state_dict['Mixed_4e.b2b.bn.bias']
    state_dict_STEP['mixed_4e.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_4e.b2b.bn.running_mean']
    state_dict_STEP['mixed_4e.branch_2.1.batch3d.running_var'] = state_dict['Mixed_4e.b2b.bn.running_var']
    state_dict_STEP['mixed_4e.branch_3.1.conv3d.weight'] = state_dict['Mixed_4e.b3b.conv3d.weight']
    state_dict_STEP['mixed_4e.branch_3.1.batch3d.weight'] = state_dict['Mixed_4e.b3b.bn.weight']
    state_dict_STEP['mixed_4e.branch_3.1.batch3d.bias'] = state_dict['Mixed_4e.b3b.bn.bias']
    state_dict_STEP['mixed_4e.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_4e.b3b.bn.running_mean']
    state_dict_STEP['mixed_4e.branch_3.1.batch3d.running_var'] = state_dict['Mixed_4e.b3b.bn.running_var']
    state_dict_STEP['mixed_4f.branch_0.conv3d.weight'] = state_dict['Mixed_4f.b0.conv3d.weight']
    state_dict_STEP['mixed_4f.branch_0.batch3d.weight'] = state_dict['Mixed_4f.b0.bn.weight']
    state_dict_STEP['mixed_4f.branch_0.batch3d.bias'] = state_dict['Mixed_4f.b0.bn.bias']
    state_dict_STEP['mixed_4f.branch_0.batch3d.running_mean'] = state_dict['Mixed_4f.b0.bn.running_mean']
    state_dict_STEP['mixed_4f.branch_0.batch3d.running_var'] = state_dict['Mixed_4f.b0.bn.running_var']
    state_dict_STEP['mixed_4f.branch_1.0.conv3d.weight'] = state_dict['Mixed_4f.b1a.conv3d.weight']
    state_dict_STEP['mixed_4f.branch_1.0.batch3d.weight'] = state_dict['Mixed_4f.b1a.bn.weight']
    state_dict_STEP['mixed_4f.branch_1.0.batch3d.bias'] = state_dict['Mixed_4f.b1a.bn.bias']
    state_dict_STEP['mixed_4f.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_4f.b1a.bn.running_mean']
    state_dict_STEP['mixed_4f.branch_1.0.batch3d.running_var'] = state_dict['Mixed_4f.b1a.bn.running_var']
    state_dict_STEP['mixed_4f.branch_1.1.conv3d.weight'] = state_dict['Mixed_4f.b1b.conv3d.weight']
    state_dict_STEP['mixed_4f.branch_1.1.batch3d.weight'] = state_dict['Mixed_4f.b1b.bn.weight']
    state_dict_STEP['mixed_4f.branch_1.1.batch3d.bias'] = state_dict['Mixed_4f.b1b.bn.bias']
    state_dict_STEP['mixed_4f.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_4f.b1b.bn.running_mean']
    state_dict_STEP['mixed_4f.branch_1.1.batch3d.running_var'] = state_dict['Mixed_4f.b1b.bn.running_var']
    state_dict_STEP['mixed_4f.branch_2.0.conv3d.weight'] = state_dict['Mixed_4f.b2a.conv3d.weight']
    state_dict_STEP['mixed_4f.branch_2.0.batch3d.weight'] = state_dict['Mixed_4f.b2a.bn.weight']
    state_dict_STEP['mixed_4f.branch_2.0.batch3d.bias'] = state_dict['Mixed_4f.b2a.bn.bias']
    state_dict_STEP['mixed_4f.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_4f.b2a.bn.running_mean']
    state_dict_STEP['mixed_4f.branch_2.0.batch3d.running_var'] = state_dict['Mixed_4f.b2a.bn.running_var']
    state_dict_STEP['mixed_4f.branch_2.1.conv3d.weight'] = state_dict['Mixed_4f.b2b.conv3d.weight']
    state_dict_STEP['mixed_4f.branch_2.1.batch3d.weight'] = state_dict['Mixed_4f.b2b.bn.weight']
    state_dict_STEP['mixed_4f.branch_2.1.batch3d.bias'] = state_dict['Mixed_4f.b2b.bn.bias']
    state_dict_STEP['mixed_4f.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_4f.b2b.bn.running_mean']
    state_dict_STEP['mixed_4f.branch_2.1.batch3d.running_var'] = state_dict['Mixed_4f.b2b.bn.running_var']
    state_dict_STEP['mixed_4f.branch_3.1.conv3d.weight'] = state_dict['Mixed_4f.b3b.conv3d.weight']
    state_dict_STEP['mixed_4f.branch_3.1.batch3d.weight'] = state_dict['Mixed_4f.b3b.bn.weight']
    state_dict_STEP['mixed_4f.branch_3.1.batch3d.bias'] = state_dict['Mixed_4f.b3b.bn.bias']
    state_dict_STEP['mixed_4f.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_4f.b3b.bn.running_mean']
    state_dict_STEP['mixed_4f.branch_3.1.batch3d.running_var'] = state_dict['Mixed_4f.b3b.bn.running_var']
    state_dict_STEP['mixed_5b.branch_0.conv3d.weight'] = state_dict['Mixed_5b.b0.conv3d.weight']
    state_dict_STEP['mixed_5b.branch_0.batch3d.weight'] = state_dict['Mixed_5b.b0.bn.weight']
    state_dict_STEP['mixed_5b.branch_0.batch3d.bias'] = state_dict['Mixed_5b.b0.bn.bias']
    state_dict_STEP['mixed_5b.branch_0.batch3d.running_mean'] = state_dict['Mixed_5b.b0.bn.running_mean']
    state_dict_STEP['mixed_5b.branch_0.batch3d.running_var'] = state_dict['Mixed_5b.b0.bn.running_var']
    state_dict_STEP['mixed_5b.branch_1.0.conv3d.weight'] = state_dict['Mixed_5b.b1a.conv3d.weight']
    state_dict_STEP['mixed_5b.branch_1.0.batch3d.weight'] = state_dict['Mixed_5b.b1a.bn.weight']
    state_dict_STEP['mixed_5b.branch_1.0.batch3d.bias'] = state_dict['Mixed_5b.b1a.bn.bias']
    state_dict_STEP['mixed_5b.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_5b.b1a.bn.running_mean']
    state_dict_STEP['mixed_5b.branch_1.0.batch3d.running_var'] = state_dict['Mixed_5b.b1a.bn.running_var']
    state_dict_STEP['mixed_5b.branch_1.1.conv3d.weight'] = state_dict['Mixed_5b.b1b.conv3d.weight']
    state_dict_STEP['mixed_5b.branch_1.1.batch3d.weight'] = state_dict['Mixed_5b.b1b.bn.weight']
    state_dict_STEP['mixed_5b.branch_1.1.batch3d.bias'] = state_dict['Mixed_5b.b1b.bn.bias']
    state_dict_STEP['mixed_5b.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_5b.b1b.bn.running_mean']
    state_dict_STEP['mixed_5b.branch_1.1.batch3d.running_var'] = state_dict['Mixed_5b.b1b.bn.running_var']
    state_dict_STEP['mixed_5b.branch_2.0.conv3d.weight'] = state_dict['Mixed_5b.b2a.conv3d.weight']
    state_dict_STEP['mixed_5b.branch_2.0.batch3d.weight'] = state_dict['Mixed_5b.b2a.bn.weight']
    state_dict_STEP['mixed_5b.branch_2.0.batch3d.bias'] = state_dict['Mixed_5b.b2a.bn.bias']
    state_dict_STEP['mixed_5b.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_5b.b2a.bn.running_mean']
    state_dict_STEP['mixed_5b.branch_2.0.batch3d.running_var'] = state_dict['Mixed_5b.b2a.bn.running_var']
    state_dict_STEP['mixed_5b.branch_2.1.conv3d.weight'] = state_dict['Mixed_5b.b2b.conv3d.weight']
    state_dict_STEP['mixed_5b.branch_2.1.batch3d.weight'] = state_dict['Mixed_5b.b2b.bn.weight']
    state_dict_STEP['mixed_5b.branch_2.1.batch3d.bias'] = state_dict['Mixed_5b.b2b.bn.bias']
    state_dict_STEP['mixed_5b.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_5b.b2b.bn.running_mean']
    state_dict_STEP['mixed_5b.branch_2.1.batch3d.running_var'] = state_dict['Mixed_5b.b2b.bn.running_var']
    state_dict_STEP['mixed_5b.branch_3.1.conv3d.weight'] = state_dict['Mixed_5b.b3b.conv3d.weight']
    state_dict_STEP['mixed_5b.branch_3.1.batch3d.weight'] = state_dict['Mixed_5b.b3b.bn.weight']
    state_dict_STEP['mixed_5b.branch_3.1.batch3d.bias'] = state_dict['Mixed_5b.b3b.bn.bias']
    state_dict_STEP['mixed_5b.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_5b.b3b.bn.running_mean']
    state_dict_STEP['mixed_5b.branch_3.1.batch3d.running_var'] = state_dict['Mixed_5b.b3b.bn.running_var']
    state_dict_STEP['mixed_5c.branch_0.conv3d.weight'] = state_dict['Mixed_5c.b0.conv3d.weight']
    state_dict_STEP['mixed_5c.branch_0.batch3d.weight'] = state_dict['Mixed_5c.b0.bn.weight']
    state_dict_STEP['mixed_5c.branch_0.batch3d.bias'] = state_dict['Mixed_5c.b0.bn.bias']
    state_dict_STEP['mixed_5c.branch_0.batch3d.running_mean'] = state_dict['Mixed_5c.b0.bn.running_mean']
    state_dict_STEP['mixed_5c.branch_0.batch3d.running_var'] = state_dict['Mixed_5c.b0.bn.running_var']
    state_dict_STEP['mixed_5c.branch_1.0.conv3d.weight'] = state_dict['Mixed_5c.b1a.conv3d.weight']
    state_dict_STEP['mixed_5c.branch_1.0.batch3d.weight'] = state_dict['Mixed_5c.b1a.bn.weight']
    state_dict_STEP['mixed_5c.branch_1.0.batch3d.bias'] = state_dict['Mixed_5c.b1a.bn.bias']
    state_dict_STEP['mixed_5c.branch_1.0.batch3d.running_mean'] = state_dict['Mixed_5c.b1a.bn.running_mean']
    state_dict_STEP['mixed_5c.branch_1.0.batch3d.running_var'] = state_dict['Mixed_5c.b1a.bn.running_var']
    state_dict_STEP['mixed_5c.branch_1.1.conv3d.weight'] = state_dict['Mixed_5c.b1b.conv3d.weight']
    state_dict_STEP['mixed_5c.branch_1.1.batch3d.weight'] = state_dict['Mixed_5c.b1b.bn.weight']
    state_dict_STEP['mixed_5c.branch_1.1.batch3d.bias'] = state_dict['Mixed_5c.b1b.bn.bias']
    state_dict_STEP['mixed_5c.branch_1.1.batch3d.running_mean'] = state_dict['Mixed_5c.b1b.bn.running_mean']
    state_dict_STEP['mixed_5c.branch_1.1.batch3d.running_var'] = state_dict['Mixed_5c.b1b.bn.running_var']
    state_dict_STEP['mixed_5c.branch_2.0.conv3d.weight'] = state_dict['Mixed_5c.b2a.conv3d.weight']
    state_dict_STEP['mixed_5c.branch_2.0.batch3d.weight'] = state_dict['Mixed_5c.b2a.bn.weight']
    state_dict_STEP['mixed_5c.branch_2.0.batch3d.bias'] = state_dict['Mixed_5c.b2a.bn.bias']
    state_dict_STEP['mixed_5c.branch_2.0.batch3d.running_mean'] = state_dict['Mixed_5c.b2a.bn.running_mean']
    state_dict_STEP['mixed_5c.branch_2.0.batch3d.running_var'] = state_dict['Mixed_5c.b2a.bn.running_var']
    state_dict_STEP['mixed_5c.branch_2.1.conv3d.weight'] = state_dict['Mixed_5c.b2b.conv3d.weight']
    state_dict_STEP['mixed_5c.branch_2.1.batch3d.weight'] = state_dict['Mixed_5c.b2b.bn.weight']
    state_dict_STEP['mixed_5c.branch_2.1.batch3d.bias'] = state_dict['Mixed_5c.b2b.bn.bias']
    state_dict_STEP['mixed_5c.branch_2.1.batch3d.running_mean'] = state_dict['Mixed_5c.b2b.bn.running_mean']
    state_dict_STEP['mixed_5c.branch_2.1.batch3d.running_var'] = state_dict['Mixed_5c.b2b.bn.running_var']
    state_dict_STEP['mixed_5c.branch_3.1.conv3d.weight'] = state_dict['Mixed_5c.b3b.conv3d.weight']
    state_dict_STEP['mixed_5c.branch_3.1.batch3d.weight'] = state_dict['Mixed_5c.b3b.bn.weight']
    state_dict_STEP['mixed_5c.branch_3.1.batch3d.bias'] = state_dict['Mixed_5c.b3b.bn.bias']
    state_dict_STEP['mixed_5c.branch_3.1.batch3d.running_mean'] = state_dict['Mixed_5c.b3b.bn.running_mean']
    state_dict_STEP['mixed_5c.branch_3.1.batch3d.running_var'] = state_dict['Mixed_5c.b3b.bn.running_var']
    state_dict_STEP['conv3d_0c_1x1.conv3d.weight'] = state_dict['logits.conv3d.weight']
    state_dict_STEP['conv3d_0c_1x1.conv3d.bias'] = state_dict['logits.conv3d.bias']
    
    if len(state_dict_STEP) == len(state_dict):
        print(f'Model Layers Match({len(state_dict_STEP)}/{len(state_dict)}), Saving...')
        torch.save(state_dict_STEP, 'pretrained/i3d_flow_kinetics.pth')
        print("Saved at 'pretrained/i3d_flow_kinetics.pth'")
    else:
        print(f"!!! Model Layers({len(state_dict_STEP)}/{len(state_dict)}) do NOT Match !!!")
    

if __name__ == "__main__":
    main()
